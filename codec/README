this codec is modified from https://github.com/mars9/codec